---
author: Longqi
comments: true
date: 2015-04-07 12:31:20
layout: post
slug: ggplot4
title: 用ggplot绘图（四）
categories: [ggplot]
tags:
- R
- Visualization
- ggplot
---
<div class="section level1">
<h1><span class="header-section-number">1</span> 数据的类型：离散和连续变量</h1>
<p>这个话题似乎离ggplot的内容有点远，但是实际上由于离散变量和连续变量在图形中的表现差别很大，所以不得不在这里稍微提出来说一下这两种变量的区别和联系。</p>
<p>在R中，数值变量被定义为连续变量，而factor和字符被定义为离散变量。这种差异在绘图中是本质的，在后面讲到<code>scale_*</code>函数时会更加明显。在这里，读者只需要知道这两类变量的处理很相当不同的。如果你知道一个变量是离散变量，最好在绘图的时候将这个变量转换为factor。而对于希望作为离散变量处理的连续变量可以使用ggplot中提供的函数<code>cut_interval</code>或者<code>cut_number</code>，两者的区别是一个是按照变量的取值来切分，一个是按照变量的个数来切分。当然，R的base里也有cut函数，可以完成类似的功能，读者可以根据个人喜好选择。</p>

<p>下面用柱状图的例子来展示，为什么说使用ggplot时，必须注意变量的类型。 例子中首先，生成一些1到7之间的随机整数<code>int</code>，然后对应到字符A到G上<code>char</code>。然后，可以看到不同的类型组合可以有以下四种不同的图形。</p>
<pre class="r"><code>int &lt;- floor(runif(1000,1,7))
ch &lt;- data.frame(char=letters[int],int)
ggplot(ch,aes(int, fill=char)) + geom_bar()</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<blockquote>
<p>stat_bin: binwidth defaulted to range/30. Use ‘binwidth = x’ to adjust this.</p>
</blockquote>
<p>这一句中，<code>int</code>是连续变量，所以直方图以前需要先确定binwidth，这也就是R弹出警告的原因，正确的使用方法是设置一个合理的binwidth。默认的binwidth就是图中看到range/30。同时注意到，右侧的色条是离散变量char。</p>
<pre class="r"><code>ggplot(ch,aes(factor(int), fill=char)) + geom_bar()</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>这一次，将<code>int</code>转换成了离散变量，所以不存在设置binwidth的问题了。R会直接按照数字出现的次数绘制直方图。同时注意到，右侧的色条也是离散变量char。</p>
<pre class="r"><code>ggplot(ch,aes(char, fill=int)) + geom_bar()</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>这一张图的色条变成了连续变量<code>int</code>，所以色条由原先的离散颜色变为了连续的过渡。由于x数据是离散变量所以也不会提示需要设置binwidth。</p>
<pre class="r"><code>ggplot(ch,aes(char, fill=factor(int))) + geom_bar()</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>这张图将前一张图中色条由连续变量换成了离散变量，由此色条也变成了离散颜色。</p>
<p>在本篇的后面我们将看到离散变量还有另外一个重要用途就是对数据进行分组。这也就是上一讲里<code>aes</code>放到不同的位置出现不同的图像的原因。不过在此之前我们需要先介绍一下ggplot中层的概念。</p>
</div>
<div class="section level1">
<h1><span class="header-section-number">2</span> 层：灵活性的源泉</h1>
<p>层是一个非常有意思的概念，在无数的架构中都会引入层的概念。因为本质上讲，层的概念是将数据结构扩展了一个维度，所以相应的会给数据结构带来大量的灵活性，而且层的概念比较容易理解，所以在诸多架构中都得到使用就很不奇怪了。那么在ggplot里面什么是层呢？</p>
<p>在ggplot里，所有的图形构件都是绘制在层上的。这也是为什么如果单运行ggplot的命令，你会遇到<code>Error: No layers in plot</code>的错误。那层是什么呢？</p>
<p>【提示】：以下内容不是官方解释，是笔者的自我感觉，可能不甚准确，欢迎批评指正。</p>
<p>层是容纳一个<code>geom</code>的容器，每个<code>geom</code>需要一个层。为什么要把<code>geom</code>各放到一个层呢？最重要的原因是不同的层可以有不同的<code>aes</code>和不同的<code>data</code>。</p>
<p>大概的联系是这样的，一个ggplot的图形首先会从ggplot函数中继承默认的aes和data。如果层内没有指定这些性质的话，就会从默认的设置中提取对应值。而如果层内给定了值的话，在这一层里这些aes和data将覆盖默认值。</p>
<p>这里有一个性质是如果将离散变量定义给出了x,y数据的其他属性的话，相应的层会根据这个离散变量进行分组。比如前面的那个例子：</p>
<pre class="r"><code>p &lt;- ggplot(mtcars,aes(wt, mpg, size=gear, color=cyl))
p + geom_point() + geom_smooth(method='lm', size=1)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>这一讲，由于载入了默认的mtcars，cyl和gear都是连续变量，所以在ggplot中设置的属性虽然传递到了其他层，但是连续变量不会分组，所以得到了一个回归曲线。</p>
<p>而下面的代码,cyl被转换成了离散变量，所以回归曲线会按照cyl的值分组。</p>
<pre class="r"><code>p &lt;- ggplot(mtcars,aes(wt, mpg, size=gear, color=factor(cyl)))
p + geom_point() + geom_smooth(method='lm', size=1)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>当然，也可以将gear也转换为离散变量，这样就会按照两个变量进行分组。所以下面的图中的右侧标识出现了相应的变化。但是奇怪的是为什么回归曲线还是三条呢？不是应该是九条吗？</p>
<pre class="r"><code>p &lt;- ggplot(mtcars,aes(wt, mpg, size=factor(gear)
                       , color=factor(cyl)))
p + geom_point() + geom_smooth(method='lm', size=1)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>如果你想到前面说的属性设置的覆盖性，你就知道因为回归线的设置中设置的size，所以在回归线中size的分组被取消了。真的是这样吗？</p>
<pre class="r"><code>p &lt;- ggplot(mtcars,aes(wt, mpg, size=factor(gear)
                       , color=factor(cyl)))
p + geom_point() + geom_smooth(method='lm')</code></pre>
<pre><code>## Warning in loop_apply(n, do.ply): NaNs produced</code></pre>
<pre><code>## Warning in loop_apply(n, do.ply): NaNs produced</code></pre>
<pre><code>## Warning in loop_apply(n, do.ply): NaNs produced</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>注意到有三个情况没有数据点来进行回归，所以只有六根回归线。</p>
<p>我想，到这里读者应该已经明白了每个geom会产生一个层，而层中的几何性质会根据属性的类型而不同。对于没有设置的属性，ggplot会到ggplot函数的定义中查找，如果没有的话就会使用默认值。</p>
<p>文章的最后，如果你想看看ggplot里面的层是什么样子的，可以用<code>str</code>函数去查看。</p>
<pre class="r"><code>p &lt;- ggplot(mtcars,aes(wt, mpg, size=factor(gear)
                       , color=factor(cyl)))
p &lt;- p + geom_point() + geom_smooth(method='lm')

print(str(p))</code></pre>
<pre><code>## List of 9
##  $ data       :'data.frame': 32 obs. of  11 variables:
##   ..$ mpg : num [1:32] 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##   ..$ cyl : num [1:32] 6 6 4 6 8 6 8 4 4 6 ...
##   ..$ disp: num [1:32] 160 160 108 258 360 ...
##   ..$ hp  : num [1:32] 110 110 93 110 175 105 245 62 95 123 ...
##   ..$ drat: num [1:32] 3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##   ..$ wt  : num [1:32] 2.62 2.88 2.32 3.21 3.44 ...
##   ..$ qsec: num [1:32] 16.5 17 18.6 19.4 17 ...
##   ..$ vs  : num [1:32] 0 0 1 1 0 1 0 1 1 1 ...
##   ..$ am  : num [1:32] 1 1 1 0 0 0 0 0 0 0 ...
##   ..$ gear: num [1:32] 4 4 4 3 3 3 3 4 4 4 ...
##   ..$ carb: num [1:32] 4 4 1 1 2 1 4 2 2 4 ...
##  $ layers     :List of 2
##   ..$ :Classes 'proto', 'environment' &lt;environment: 0x0325ba44&gt; 
##   ..$ :Classes 'proto', 'environment' &lt;environment: 0x032dc248&gt; 
##  $ scales     :Reference class 'Scales' [package &quot;ggplot2&quot;] with 1 fields
##   ..$ scales: list()
##   ..and 21 methods, of which 9 are possibly relevant:
##   ..  add, clone, find, get_scales, has_scale, initialize, input, n,
##   ..  non_position_scales
##  $ mapping    :List of 4
##   ..$ x     : symbol wt
##   ..$ y     : symbol mpg
##   ..$ size  : language factor(gear)
##   ..$ colour: language factor(cyl)
##  $ theme      : list()
##  $ coordinates:List of 1
##   ..$ limits:List of 2
##   .. ..$ x: NULL
##   .. ..$ y: NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;cartesian&quot; &quot;coord&quot;
##  $ facet      :List of 1
##   ..$ shrink: logi TRUE
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;null&quot; &quot;facet&quot;
##  $ plot_env   :&lt;environment: R_GlobalEnv&gt; 
##  $ labels     :List of 4
##   ..$ x     : chr &quot;wt&quot;
##   ..$ y     : chr &quot;mpg&quot;
##   ..$ size  : chr &quot;factor(gear)&quot;
##   ..$ colour: chr &quot;factor(cyl)&quot;
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;gg&quot; &quot;ggplot&quot;
## NULL</code></pre>
<p>注意到<code>layers</code>变量是长度为2的列表，正好是这里定义的两层，一个<code>point</code>一个<code>smooth</code>。还可以看到<code>layers</code>下面有一个叫<code>scales</code>的东西，这个是干什么的呢？这个就是下一讲的内容，通过调整scales你就可以控制图形中点的大小范围，线的粗细范围等等。</p>
</div>

