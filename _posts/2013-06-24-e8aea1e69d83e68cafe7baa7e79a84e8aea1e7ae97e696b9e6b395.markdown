---
author: Longqi
comments: true
date: 2013-06-24 07:34:10+00:00
layout: post
slug: '%e8%ae%a1%e6%9d%83%e6%8c%af%e7%ba%a7%e7%9a%84%e8%ae%a1%e7%ae%97%e6%96%b9%e6%b3%95'
title: 计权振级的计算方法
wordpress_id: 25
tags:
- 1/3倍频程
- Environmental Vibration
- Reasearch News
- Vibration Assessment
- 振级
- 环境振动
- 计权算法
---

环境振动通常使用加速度和速度进行评价，但是在振动幅值相同的情况下，不同有效值或频率成分的振动人体的感觉有明显不同。因此，研究者们提出了一些通过对不同的频率成分使用不同的计权系数的评价方法，其中使用的最为广泛的是ISO2631-1中提出的Wk计权方法。由于地铁导致的环境振动作用时间较短，且有较为明显的冲击效应，按照ISO2631-1的建议，应使用地铁通过时间内逐秒分析的计权均方根加速度最大值作为评价量。根据我国环境振动的惯例，使用如下式所定义的振级作为环境振动的评价量，本文将沿用这一做法。


\begin{equation}
V{L_{\max }} = 20\lg \left( {\frac{{{a_w}}}{{{a_0}}}} \right)
\end{equation}
其中， [latex]a_w[/latex]为计权加速度值， [latex]a_0 [/latex]为基准加速度，我国取 [latex]1\times 10^{-6} \mathrm{m/s}^2 [/latex].


## 最大计权振级的计算方法




最大计权振级是按照给定步长 [latex]\tau=1\mathrm{s} [/latex]计算均方根计权加速度在总的测试时间内的最大值所对应的分贝值。其表达式如下式所示。计算最大计权振级需要首先确定 MTVV，MTVV的计算方法是选取总测试时间内，以步长 [latex]\tau=1\mathrm{s} [/latex]计算的均方根计权加速度的最大值，其数学表达式如下式所示。
\begin{equation}\label{ZdB}
{\bar a_w}\left( {{t_0}} \right) = {\left\{ {\frac{1}{\tau }\int_{{t_0} - \tau }^{{t_0}} {{{\left[ {{a_w}\left( t \right)} \right]}^2}{\rm{d}}t} } \right\}^{1/2}}
\end{equation}


\begin{equation}\label{MTVV}
MTVV = \max \left[ {{{\bar a}_w}\left( {{t_0}} \right)} \right]
\end{equation}

其中，[latex] t [/latex]为积分时长，[latex]{\bar a_w}\left( {{t_0}} \right)[/latex]为[latex]t_0[/latex]为终止时间的t秒时间长度的均方根计权加速度，[latex]a_w(t)[/latex]是计权加速度时程。


由此，最大计权振级的计算实际划归为计算计权加速度[latex]a_w(t)[/latex]均方根的问题。计权加速度[latex]a_w(t)[/latex]是按照特定频率计权曲线计权后的加速度时程曲线。频率计权曲线是一组反应了人体在不同方向不同频率下的反应的计权曲线。通过计权后的加速度可以在一定程度上反映人体对振动的反应，这就是使用计权加速度作为环境振动评价标准的原因。由于对于大多数环境振动问题都只讨论竖直方向的振动情况，也即使用标准中的Wk计权，因此本报告将以Wk为范例演示最大计权振级的计算方法，本报告讨论的方法对于其他计权也是适用的。




计算均方根计权加速度的方法可以分为两类，也即时域法和频域法。频域法基于Parseval定理进行，一般首先进行1/3倍频程的估计，再在此基础上计算均方根计权加速度值。时域法则基于滤波器组方法完成，由于不需要变换到频域，因此获得的是计权后的加速度时程曲线。




下面对频域方法进行介绍。


<!-- more -->


## 频域法




ISO2631-1正文中给出了基于频域计权的计权因子。在计权时间足够长的情况下，可以使用计权因子进行计权加速度的计算，通过笔者的尝试当时间步长大于8s时，该方法获得的计算结果与其他方法吻合良好。如前所述，使用频域进行均方根计权加速度的方法基于Parseval定理导出道时频域能量相同的事实。根据Parseval定理可知，信号的均方根的平方可表达为




\begin{equation}
{a^2} = \frac{1}{T}\int_0^T {{a^2}} \left( t \right){\rm{d}}t = \frac{1}{T}\int_{ - \infty }^{ + \infty } {{{\left| {A\left( \omega \right)} \right|}^2}{\rm{d}}\omega = \frac{1}{T}{\rm{PSD}}\left( a \right)}
\end{equation}
其中，[latex]A(\omega)[/latex]为信号[latex]a(t)[/latex]的Fourier变换，[latex]\mathrm{PSD}(a)[/latex]是信号的单边功率谱。




因此，在频域内对功率谱计权求和可直接得到时域内的均方根计权加速度值，而无需将信号反转回时域再计算均方根。该方法中仅需使用快速傅立叶变换(FFT)，计算速度很快。唯一的问题在于频率计权因子是按照1/3倍频程给出的，计算时需要将功率谱转化为1/3倍频程。由于信号FFT的频率分辨率仅为1Hz，对于频带数小于7的1/3倍频带都存在无法确定能量大小的问题。再没有更好的选择之前，可以将功率谱在频率轴上平均，再按照1/3倍频带进行积分获得1/3倍频程的估计，在此过程中有两点需要注意。




第一，不应对功率谱进行插值处理，插值后的结果不满足Parseval定理，而因将能量平均分布到频率轴上；




第二，若最终需要对信号进行计权，则信号的零频响应不能进行平均。这是因为计权曲线中零频响应是没有计权值的。




对于频带数大于7的1/3倍频带可以使用哈希表快速完成1/3倍频程的计算。与标准哈希表不同的是，在发生对冲时，只需将哈希表中的数值和当前值直接累加即可，无需生成整个哈希表再进行逐项累加。生成哈希表使用的散列函数如下式所示：
\begin{equation}
{\rm{Hash}} = \left\lfloor {3{{\log }_2}f + 0.5} \right\rfloor
\end{equation}
其中，[latex]f[/latex]为频率值，所得的Hash值对应的为标准中的倍频带值。




对上述哈希表的初始几个倍频带做前述的平均处理之后，再按照哈希值查表计权求均方根值就可以得到均方根计权加速度值了。获得逐[latex]\tau[/latex]秒的均方根计权加速度值之后，计算加速度有效值，再根据最大振级的定义式就可以进行最大振级的计算了。





## 时域法




ISO2631-1的附录中给出了计权加速度计权曲线的数学表达式，因此可以使用滤波器组直接对加速度进行计权以获得计权后的加速度时程，再计算计权后加速度时程的均方根就可以获得均方根计权加速度。该方法避免了频域法中一些理论上的困难，硬件实现上也比较容易，因此推荐使用本方法进行最大计权振级的计算。该方法的实现细节可以参见《噪声与振动控制》2013年第5期中“最大计权振级计算方法的探讨”一文的内容。





ISO2631: 带通滤波器


[![band](http://bcs.duapp.com/pecker/blog/201306/band2.png)](http://bcs.duapp.com/pecker/blog/201306/band2.png)


ISO2631: A-V滤波器


[![av](http://bcs.duapp.com/pecker/blog/201306/av2.png)](http://bcs.duapp.com/pecker/blog/201306/av2.png)


ISO2631: 高阶滤波器


[![wrap](http://bcs.duapp.com/pecker/blog/201306/wrap2.png)](http://bcs.duapp.com/pecker/blog/201306/wrap2.png)



## 各方法在计算最大计权振级问题上的对比




基于频域的计算方法，其主要误差来源是低频段的1/3倍频程估计，在信号的主要成分不落在低频段的信号，该方法能够获得良好的计算结果。该方法可使用FFT实现功率谱估计，从功率谱到1/3倍频程可以使用哈希表直接散列，这两种算法都有极高的运行效率。因此如果只需进行单次计算，该方法的精度和运算速度都是比较优良的。同时作为该方法的副产品，在分析中可以获得信号的功率谱估计和频谱特性，还可以获得一个比较准确的1/3倍频程结果。




基于精确数学表达的时域滤波器实现方法，其主要误差来源是双线性变换带来的误差。但作为一种常用的模拟滤波器转换为数字滤波器的方法，在本问题中，双线性变换引入的误差是可以接受的。同时，该方法需要的数字滤波器在采样频率已知的情况下可以预先得到，因此主要的计算时间是滤波的时间。由于滤波函数的也具有很好的运行效率，因此该方法的效率也是相当优良的。另外，本方法最终产生的是计权加速度的时程曲线，这使得该方法的中间产品可以用来进行VDV，峰值因数等评价量，这为使用多种振动评价量进行振动评价提供了方便。最为关键的是，本方法还具有一个重要的特点：利用计权加速度的时域曲线可以设计一个均方根计权加速度的增量算法，由此可以极为高效的获得准确的MTVV。该增量方法将在后文中介绍。




基于1/3倍频程滤波器组的计算方法，其主要误差来源是1/3倍频程滤波器组的误差。该方法的主要缺陷在于需要经过的滤波器个数和内存占用都较其他两种方法要大。但该方法同时产生了准确的1/3倍频程，这一算法可以在同时需要准确的1/3倍频程结果的情况下使用。鉴于本文主要讨论最大计权振级的计算方法，该方法并不具有太多的优势。





## 基于增量的最大计权振级计算方法




如果需要准确计算MTVV，使用文中提及的其他方法都面临着巨大的计算开支。以最为常见的频域方法为例，虽然使用了FFT算法，计算一秒的功率谱的时间长度仍然为[latex]O(Fs \log(Fs))[/latex]，如果逐点依次分析的话，完成[latex]MTVV[/latex]计算的总时间复杂度为[latex]O(n Fs \log(Fs))[/latex]。对于一般的数据n与Fs往往比较相似，因此频域计算方法的时间复杂度为[latex]O(n^2\log(n))[/latex]。类似的，由于滤波算法的时间复杂度与FFT一致，时域算法的复杂度也是[latex]O(n^2\log(n))[/latex]，对于1/3倍频程算法，每一个1/3倍频程需要一次滤波，但其时间复杂度也是[latex]O(n^2\log(n))[/latex]。因此在计算MTVV时，部分商业软件的做法是通过选取一个较小的移动步长，比如0.5s，获得[latex]MTVV[/latex]的一个估计。在振动信号变化不明显的情况下，这种近似往往是可以接受的，如果信号的波动瞬时性较强，获得的估计随不同时间起点的变化也比较剧烈。同时，即便使用这种近似估计的方法，对于数小时或数天的数据，这也是一个相当耗时的工作。为此，笔者提出了一套基于增量的[latex]MTVV[/latex]计算方法，该方法的算法效率非常可观，其计算复杂度为[latex]O(n\log(n))[/latex]，也即比一般算法快n倍，算法的理论内容可参见“最大计权振级计算方法的探讨”一文中的内容。





频域法计算流程图


[![freq](http://bcs.duapp.com/pecker/blog/201306/freq2.png)](http://bcs.duapp.com/pecker/blog/201306/freq2.png)


时域滤波计算流程图


[![time](http://bcs.duapp.com/pecker/blog/201306/time2.png)](http://bcs.duapp.com/pecker/blog/201306/time2.png)


1/3倍频程滤波计算流程图


[![oct](http://bcs.duapp.com/pecker/blog/201306/oct2.png)](http://bcs.duapp.com/pecker/blog/201306/oct2.png)



